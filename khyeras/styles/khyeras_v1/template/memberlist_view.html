<!-- INCLUDE overall_header.html -->

{% macro field_lists(name, value) %}
	{% if value %}
		<dt>{{ name }}{L_COLON}</dt>
		<dd>{{ value }}</dd>
	{% endif %}
{% endmacro %}

<h2 class="memberlist-title">{PAGE_TITLE}</h2>

<form method="post" action="{S_PROFILE_ACTION}" id="viewprofile">

<!-- IF PROFILE_ACCOUNT_TYPE_VALUE == 'Character' -->
	{% set character_class = 'character-panel tab-panel show-panel' %}
	{% set writer_class = 'writer-panel tab-panel hide-panel' %}
	<div id="tabs" class="tabs profile-tabs sub-panels" role="tablist">
		<ul>
			<li class="tab activetab">
				<a data-tabname="character-panel" role="tab" aria-controls="character-panel">Character</a>
			</li>
			<li class="tab">
				<a data-tabname="writer-panel" role="tab" aria-controls="writer-panel">Writer</a>
			</li>
		</ul>
	</div>
<!-- ENDIF -->

<div class="panel bg1<!-- IF S_ONLINE --> online<!-- ENDIF --> profile-panel">
	<div class="inner">
		<dl class="left-box postprofile">
			<dt class="<!-- IF RANK_TITLE or RANK_IMG -->has-profile-rank<!-- ELSE -->no-profile-rank<!-- ENDIF --> <!-- IF AVATAR_IMG -->has-avatar<!-- ELSE -->no-avatar<!-- ENDIF -->">
				<!-- IF AVATAR_IMG -->
					<div class="avatar-container">
						<div class="avatar">{AVATAR_IMG}</div>
					</div>
				<!-- ENDIF -->
				<span class="username-coloured"<!-- IF USER_COLOR --> style="color: {USER_COLOR};"<!-- ENDIF -->>{USERNAME}</span>
			</dt>
			<!-- IF AVATAR_IMG -->
				<!-- EVENT memberlist_view_rank_avatar_before -->
			<!-- ELSE -->
				<!-- EVENT memberlist_view_rank_no_avatar_before -->
			<!-- ENDIF -->
			<!-- IF RANK_TITLE or RANK_IMG or S_PROFILE_TITLE -->
				<dd class="profile-rank">
					<!-- IF RANK_TITLE or RANK_IMG -->
						<div class="rank-label">{RANK_TITLE}</div>
						<!-- IF RANK_IMG -->
							<div class="rank-image">{RANK_IMG}</div>
						<!-- ENDIF -->
					<!-- ENDIF -->
					<!-- IF S_PROFILE_TITLE -->
						<div class="title-label">{PROFILE_TITLE_VALUE}</div>
					<!-- ENDIF -->
				</dd>
			<!-- ENDIF -->
			<!-- IF AVATAR_IMG -->
				<!-- EVENT memberlist_view_rank_avatar_after -->
			<!-- ELSE -->
				<!-- EVENT memberlist_view_rank_no_avatar_after -->
			<!-- ENDIF -->
			<!-- IF U_EDIT_SELF or U_USER_ADMIN or U_USER_BAN or U_SWITCH_PERMISSIONS -->
				<dd class="profile-permissions">
					<!-- IF U_EDIT_SELF --> [ <a href="{U_EDIT_SELF}">{L_EDIT_PROFILE}</a> ]<!-- ENDIF -->
					<!-- IF U_USER_ADMIN --> [ <a href="{U_USER_ADMIN}">{L_USER_ADMIN}</a> ]<!-- ENDIF -->
					<!-- IF U_USER_BAN --> [ <a href="{U_USER_BAN}">{L_USER_BAN}</a> ]<!-- ENDIF -->
					<!-- IF U_SWITCH_PERMISSIONS --> [ <a href="{U_SWITCH_PERMISSIONS}">{L_USE_PERMISSIONS}</a> ]<!-- ENDIF -->
				</dd>
			<!-- ENDIF -->
		</dl>
		<!-- IF PROFILE_ACCOUNT_TYPE_VALUE == 'Character' -->
			<dl class="left-box details profile-details {{ character_class }}">
				<dd class="character-card details-full">
					<div class="level">
						<div class="level-wrap">
							<span class="level-name">Level</span>
							<span class="level-value">{{ KHY_MEMBER_LEVEL }}</span>
						</div>
					</div>
					<!-- IF S_PROFILE_C_HP or S_PROFILE_C_MP -->
						{% set remaining_hp = KHY_MEMBER_TOTAL_HP - PROFILE_C_HP_VALUE %}
						{% set remaining_mp = KHY_MEMBER_TOTAL_MP - PROFILE_C_MP_VALUE %}
						<div class="stats">
							{% if S_PROFILE_C_HP %}
								<div class="stat-bar stat-bar-small hp-bar">
									<div class="stat-bar-inner" style="width: {{ ((remaining_hp / KHY_MEMBER_TOTAL_HP) * 100) | number_format(2) }}%"></div>
									<div class="stat-bar-label">
										{{ remaining_hp }} / {{ KHY_MEMBER_TOTAL_HP }} {{ PROFILE_C_HP_NAME }}
									</div>
								</div>
							{% endif %}
							{% if S_PROFILE_C_MP %}
								<div class="stat-bar stat-bar-small mp-bar">
									<div class="stat-bar-inner" style="width: {{ ((remaining_mp / KHY_MEMBER_TOTAL_MP) * 100) | number_format(2) }}%"></div>
									<div class="stat-bar-label">
										{{ remaining_mp }} / {{ KHY_MEMBER_TOTAL_MP }} {{ PROFILE_C_MP_NAME }}
									</div>
								</div>
							{% endif %}
						</div>
					<!-- ENDIF -->
				</dd>
				{% set religion_value = (PROFILE_C_RELIGION_TYPE_VALUE) ~ (S_PROFILE_C_RELIGION_OPTS ? (' - ' ~ PROFILE_C_RELIGION_OPTS_VALUE) : '') %}

				{% set character_fields = {
					'Experience'  				 : (PROFILE_C_EXPERIENCE_VALUE ? PROFILE_C_EXPERIENCE_VALUE : '&#48;'),
					(PROFILE_C_RACE_OPTS_NAME)   : PROFILE_C_RACE_OPTS_VALUE|replace({', ': ' and '}),
					(PROFILE_C_CLASS_OPTS_NAME)  : PROFILE_C_CLASS_OPTS_VALUE|replace({', ': ' and '}),
					(PROFILE_C_AGE_NAME)         : PROFILE_C_AGE_VALUE,
					(PROFILE_C_GENDER_NAME)      : PROFILE_C_GENDER_VALUE,
					(PROFILE_PRONUNCIATION_NAME) : PROFILE_PRONUNCIATION_VALUE,
					(PROFILE_C_ORIGIN_NAME)      : PROFILE_C_ORIGIN_VALUE,
					(PROFILE_C_RESIDENCE_NAME)   : PROFILE_C_RESIDENCE_VALUE,
					'Religion' 					 : religion_value,
				} %}

				{% for name, value in character_fields %}
					{{ _self.field_lists(name, value) }}
				{% endfor %}
			</dl>
		<!-- ENDIF -->
		<dl class="left-box details profile-details<!-- IF PROFILE_ACCOUNT_TYPE_VALUE == 'Character' --> {{ writer_class }}<!-- ENDIF -->">
			<!-- EVENT memberlist_view_zebra_before -->
			<!-- IF S_USER_LOGGED_IN and S_ZEBRA -->
				<dt>Alliance{L_COLON}</dt>
				<!-- IF U_REMOVE_FRIEND -->
					 <dd class="zebra">
						 <a href="{U_REMOVE_FRIEND}" data-ajax="zebra">
							 <i class="icon rpg-icon rpg-shaking-hands"></i>{L_REMOVE_FRIEND}
						 </a>
					 </dd>
				<!-- ELSEIF U_REMOVE_FOE -->
					<dd class="zebra">
						<a href="{U_REMOVE_FOE}" data-ajax="zebra">
							<i class="icon rpg-icon rpg-evil-hand"></i>{L_REMOVE_FOE}
						</a>
					</dd>
				<!-- ELSE -->
					<dd class="zebra">
						<!-- IF U_ADD_FRIEND -->
							<a href="{U_ADD_FRIEND}" data-ajax="zebra">
								<i class="icon rpg-icon rpg-shaking-hands"></i>{L_ADD_FRIEND}
							</a>
						<!-- ENDIF -->
						<!-- IF U_ADD_FOE -->
							<span class="bullet">&bull;</span>
							<a href="{U_ADD_FOE}" data-ajax="zebra">
								<i class="icon rpg-icon rpg-evil-hand"></i>{L_ADD_FOE}
							</a>
						<!-- ENDIF -->
					</dd>
				<!-- ENDIF -->
			<!-- ENDIF -->
			<!-- EVENT memberlist_view_zebra_after -->
			<!-- IF S_USER_INACTIVE -->
				<dt>{L_USER_IS_INACTIVE}{L_COLON}</dt>
				<dd>{USER_INACTIVE_REASON}</dd>
			<!-- ENDIF -->
			<!-- EVENT memberlist_view_non_contact_custom_fields_before -->
			{% if S_PROFILE_C_WRITER_NAME %}
				{% set writer_value %}
					For more information, see <a href="{BOARD_URL}{PROFILE_C_WRITER_NAME_CONTACT}">{PROFILE_C_WRITER_NAME_VALUE}</a>.
				{% endset %}
			{% else %}
				{% set writer_value = '' %}
			{% endif %}

			{% set writer_fields = {
				'Age' 							: (S_PROFILE_C_WRITER_NAME ? '' : AGE),
				(PROFILE_GENDER_NAME) 			: (S_PROFILE_C_WRITER_NAME ? '' : PROFILE_GENDER_VALUE),
				(PROFILE_PRONUNCIATION_NAME)    : (PROFILE_ACCOUNT_TYPE_VALUE == 'Writer' ? PROFILE_PRONUNCIATION_VALUE : ''),
				(PROFILE_PHPBB_LOCATION_NAME)   : (S_PROFILE_C_WRITER_NAME ? '' : PROFILE_PHPBB_LOCATION_VALUE),
				(PROFILE_PHPBB_INTERESTS_NAME)  : (S_PROFILE_C_WRITER_NAME ? '' : PROFILE_PHPBB_INTERESTS_VALUE),
				(PROFILE_PHPBB_OCCUPATION_NAME) : (S_PROFILE_C_WRITER_NAME ? '' : PROFILE_PHPBB_OCCUPATION_VALUE),
				(PROFILE_C_WRITER_NAME_NAME)    : writer_value,
				(PROFILE_AVATAR_CREDIT_NAME)    : PROFILE_AVATAR_CREDIT_VALUE,
				(PROFILE_SIG_CREDIT_NAME)       : PROFILE_SIG_CREDIT_VALUE
			} %}

			{% for name, value in writer_fields %}
				{{ _self.field_lists(name, value) }}
			{% endfor %}
			<!-- EVENT memberlist_view_non_contact_custom_fields_after -->
			<!-- IF S_GROUP_OPTIONS -->
				<dt>{L_USERGROUPS}{L_COLON}</dt>
				<dd class="group-options"><select name="g">{S_GROUP_OPTIONS}</select> <input type="submit" name="submit" value="{L_GO}" class="button2" /></dd>
			<!-- ENDIF -->
		</dl>
	</div>
</div>

<!-- IF PROFILE_ACCOUNT_TYPE_VALUE == 'Character' -->
	<div class="{{ character_class }}" role="tabpanel">
		<div class="panel bg2">
			<div class="inner">
				<div class="column1">
					<h3>Physical Features</h3>
					<dl class="details">
						{% set feature_fields = {
							(PROFILE_C_COMPLEXION_NAME) : PROFILE_C_COMPLEXION_VALUE,
							(PROFILE_C_HAIR_NAME)       : PROFILE_C_HAIR_VALUE,
							(PROFILE_C_EYES_NAME)   	: PROFILE_C_EYES_VALUE,
							(PROFILE_C_HEIGHT_NAME)  	: PROFILE_C_HEIGHT_VALUE,
							(PROFILE_C_WEIGHT_NAME) 	: PROFILE_C_WEIGHT_VALUE
						} %}

						{% for name, value in feature_fields %}
							{{ _self.field_lists(name, value) }}
						{% endfor %}
					</dl>
					<p class="other-features"><strong>Other Features{L_COLON}</strong></p>
					<!-- IF S_PROFILE_C_FEATURES -->
						<p>{{ PROFILE_C_FEATURES_VALUE|replace({'<br /><br />': '</p><p>'}) }}</p>
					<!-- ELSE -->
						<p>There's nothing here yet...</p>
					<!-- ENDIF -->
				</div>
				<div class="column2">
					<h3>Personality</h3>
					<!-- IF S_PROFILE_C_PERSONALITY -->
						<p>{{ PROFILE_C_PERSONALITY_VALUE|replace({'<br /><br />': '</p><p>'}) }}</p>
					<!-- ELSE -->
						<p>There's nothing here yet...</p>
					<!-- ENDIF -->
					<h3>Relationships and Companions</h3>
					<!-- IF S_PROFILE_C_RELATIONSHIPS -->
						<p>{{ PROFILE_C_RELATIONSHIPS_VALUE|replace({'<br /><br />': '</p><p>'}) }}</p>
					<!-- ELSE -->
						<p>There's nothing here yet...</p>
					<!-- ENDIF -->
				</div>
			</div>
		</div>
		<div class="panel bg2">
			<div class="inner">
				<h3>Background</h3>
				<!-- IF S_PROFILE_C_BACKGROUND -->
					<p>{{ PROFILE_C_BACKGROUND_VALUE|replace({'<br /><br />': '</p><p>'}) }}</p>
				<!-- ELSE -->
					<p>There's nothing here yet...</p>
				<!-- ENDIF -->
			</div>
		</div>
	</div>
<!-- ENDIF -->

<!-- EVENT memberlist_view_contact_before -->
<!-- IF PROFILE_ACCOUNT_TYPE_VALUE == 'Character' -->
	<div class="{{ writer_class }}" role="tabpanel">
<!-- ENDIF -->
		<!-- IF S_PROFILE_WRITING_PREFS and not S_PROFILE_C_WRITER_NAME -->
			<div class="panel bg2">
				<div class="inner">
					<h3>{PROFILE_WRITING_PREFS_NAME}</h3>
					<p>{PROFILE_WRITING_PREFS_VALUE}</p>
				</div>
			</div>
		<!-- ENDIF -->
		<div class="panel bg2">
			<div class="inner">
				<!-- EVENT memberlist_view_content_prepend -->
				<!-- IF not S_PROFILE_C_WRITER_NAME -->
					<div class="user-contact">
						<h3>{L_CONTACT_USER}</h3>
						<div class="contact-icons">
							<!-- IF U_EMAIL -->
								<a href="{U_EMAIL}" title="{L_SEND_EMAIL_USER}">
									<span class="contact-icon email-icon">{L_SEND_EMAIL_USER}</span>
								</a>
							<!-- ENDIF -->
							<!-- IF U_PM -->
								<a href="{U_PM}" title="{L_SEND_PRIVATE_MESSAGE}">
									<span class="contact-icon pm-icon">{L_SEND_PRIVATE_MESSAGE}</span>
								</a>
							<!-- ENDIF -->
							<!-- IF U_JABBER and S_JABBER_ENABLED -->
								<a href="{U_JABBER}" onclick="popup(this.href, 750, 320); return false;" title="{L_SEND_JABBER_MESSAGE}">
									<span class="contact-icon jabber-icon">{L_SEND_JABBER_MESSAGE}</span>
								</a>
							<!-- ENDIF -->
							<!-- BEGIN custom_fields -->
								<!-- IF custom_fields.S_PROFILE_CONTACT and custom_fields.PROFILE_FIELD_CONTACT -->
									<a href="{custom_fields.PROFILE_FIELD_CONTACT}" title="{custom_fields.PROFILE_FIELD_DESC}">
										<span class="contact-icon {custom_fields.PROFILE_FIELD_IDENT}-icon">{custom_fields.PROFILE_FIELD_DESC}</span>
									</a>
								<!-- ENDIF -->
							<!-- END custom_fields -->
						</div>
						<dl class="details">
							<!-- IF USER_JABBER -->
								<dt>{L_JABBER}{L_COLON}</dt>
								<dd>{USER_JABBER}</dd>
							<!-- ENDIF -->
							<!-- EVENT memberlist_view_contact_custom_fields_before -->
							<!-- BEGIN custom_fields -->
								<!-- IF custom_fields.S_PROFILE_CONTACT and not custom_fields.PROFILE_FIELD_CONTACT -->
									<dt>{custom_fields.PROFILE_FIELD_NAME}{L_COLON}</dt>
									<dd>{custom_fields.PROFILE_FIELD_VALUE}</dd>
								<!-- ENDIF -->
							<!-- END custom_fields -->
							<!-- EVENT memberlist_view_contact_custom_fields_after -->
						</dl>
					</div>
				<!-- ENDIF -->
				<div class="user-stats">
					<h3>{L_USER_FORUM}</h3>
					<dl class="details">
						<!-- EVENT memberlist_view_user_statistics_before -->
						<dt>{L_JOINED}{L_COLON}</dt>
						<dd>{JOINED}</dd>
						<dt>{L_LAST_ACTIVE}{L_COLON}</dt>
						<dd>{LAST_ACTIVE}</dd>
						<!-- IF S_WARNINGS -->
							<dt>{L_WARNINGS}{L_COLON} </dt>
							<dd>
								<strong>{WARNINGS}</strong>
								<!-- IF U_NOTES or U_WARN --> [ <!-- IF U_NOTES --><a href="{U_NOTES}">{L_VIEW_NOTES}</a><!-- ENDIF --> <!-- IF U_WARN --><!-- IF U_NOTES --> | <!-- ENDIF --><a href="{U_WARN}">{L_WARN_USER}</a><!-- ENDIF --> ]<!-- ENDIF -->
							</dd>
						<!-- ENDIF -->
						<dt>{L_TOTAL_POSTS}{L_COLON}</dt>
						<dd>
							{POSTS} <!-- IF S_DISPLAY_SEARCH -->| <strong><a href="{U_SEARCH_USER}">{L_SEARCH_USER_POSTS}</a></strong><!-- ENDIF -->
							<!-- IF POSTS_PCT --><br />({POSTS_PCT} / {POSTS_DAY})<!-- ENDIF -->
							<!-- IF POSTS_IN_QUEUE and U_MCP_QUEUE --><br />&nbsp;(<a href="{U_MCP_QUEUE}">{L_POSTS_IN_QUEUE}</a>)<!-- ELSEIF POSTS_IN_QUEUE --><br />&nbsp;({L_POSTS_IN_QUEUE})<!-- ENDIF -->
						</dd>
						<!-- IF S_SHOW_ACTIVITY and POSTS -->
							<dt>{L_ACTIVE_IN_FORUM}{L_COLON}</dt>
							<dd><!-- IF ACTIVE_FORUM != '' --><strong><a href="{U_ACTIVE_FORUM}">{ACTIVE_FORUM}</a></strong><br />({ACTIVE_FORUM_POSTS} / {ACTIVE_FORUM_PCT})<!-- ELSE --> - <!-- ENDIF --></dd>
							<dt>{L_ACTIVE_IN_TOPIC}{L_COLON}</dt>
							<dd><!-- IF ACTIVE_TOPIC != '' --><strong><a href="{U_ACTIVE_TOPIC}">{ACTIVE_TOPIC}</a></strong><br />({ACTIVE_TOPIC_POSTS} / {ACTIVE_TOPIC_PCT})<!-- ELSE --> - <!-- ENDIF --></dd>
						<!-- ENDIF -->
						<!-- EVENT memberlist_view_user_statistics_after -->
					</dl>
				</div>
				<div class="extra-details">
					<!-- EVENT memberlist_view_content_append -->
				</div>
			</div>
		</div>
<!-- IF PROFILE_ACCOUNT_TYPE_VALUE == 'Character' -->
	</div>
<!-- ENDIF -->
<!-- EVENT memberlist_view_contact_after -->

<!-- IF SIGNATURE -->
<div class="panel bg1">
	<div class="inner">
		<h3>{L_SIGNATURE}</h3>
		<div class="postbody"><div class="signature standalone">{SIGNATURE}</div></div>
	</div>
</div>
<!-- ENDIF -->

</form>

<!-- INCLUDE jumpbox.html -->

<!-- INCLUDE overall_footer.html -->
